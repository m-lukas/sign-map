<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8">
    <title>Sign-Map</title>
    <script type='text/javascript' src="https://code.jquery.com/jquery-3.2.1.js"></script>
    <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyANVBn98XfLAjJ8iK-fG6v63LuW3uc88X4"></script>
    <script src="https://www.gstatic.com/firebasejs/4.6.0/firebase.js"></script>
    <script src="USGSOverlay.js"></script>
    <link rel="stylesheet" type="text/css" href="css/style.css">
  </head>
  <body>
    <div class="mapWrapper">
        <div id="map"></div>
        <div class="sidebar"></div>
    </div>
    <script>
        // You can also require other files to run in this process
        require('./renderer.js');
        const App = require('./App.js');
        const signs = require('./signs.js');

        function initMap() {

            minZoomLevel = 18;

            App.map = new google.maps.Map(document.getElementById('map'), {
              zoom: minZoomLevel,
              minZoom: minZoomLevel,
              center: {lat: 51.141929, lng: 14.980407},
              draggableCursor: 'crosshair',
              streetViewControl: false,
              //fullscreenControl: false,
              mapTypeControl: false
            });

            let bounds = new google.maps.LatLngBounds(
              new google.maps.LatLng(51.140760, 14.978550),
              new google.maps.LatLng(51.143140, 14.982280));

            google.maps.event.addListener(App.map, 'dragend', function() {
                if(bounds.contains(App.map.getCenter())) return;

                let c = App.map.getCenter(),
                    x = c.lng(),
                    y = c.lat(),
                    maxX = bounds.getNorthEast().lng(),
                    maxY = bounds.getNorthEast().lat(),
                    minX = bounds.getSouthWest().lng(),
                    minY = bounds.getSouthWest().lat();

                if(x < minX) x = minX;
                if(x > maxX) x = maxX;
                if(y < minY) y = minY;
                if(y > maxY) y = maxY;

                App.map.setCenter(new google.maps.LatLng(y,x));

            });

            new USGSOverlay(bounds, './images/map/TP-Map.png', App.map);

            firebase.initializeApp(App.dbConfig);
            App.database = firebase.database();

            signs.loadSigns();

            console.log(App.signList)

        }

        google.maps.event.addDomListener(window, 'load', initMap);

    </script>
  </body>
</html>
